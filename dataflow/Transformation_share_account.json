{
	"name": "Transformation_share_account",
	"properties": {
		"folder": {
			"name": "INTIAL LOAD"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Share_accountcsv",
						"type": "DatasetReference"
					},
					"name": "source"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Share_account",
						"type": "DatasetReference"
					},
					"name": "sink1",
					"rejectedDataLinkedService": {
						"referenceName": "AzureBlobStorage1",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          PWC_Key as string,",
				"          ID as string,",
				"          CHECKDIGITS as string,",
				"          TYPE as string,",
				"          LASTFMDATE as string,",
				"          LASTTRANDATE as string,",
				"          OPENDATE as string,",
				"          CLOSEDATE as string,",
				"          REFERENCE as string,",
				"          WARNINGCODE1 as string,",
				"          WARNINGCODE2 as string,",
				"          WARNINGCODE3 as string,",
				"          WARNINGCODE4 as string,",
				"          WARNINGCODE5 as string,",
				"          WARNINGCODE6 as string,",
				"          WARNINGCODE7 as string,",
				"          WARNINGCODE8 as string,",
				"          WARNINGCODE9 as string,",
				"          WARNINGCODE10 as string,",
				"          WARNINGCODE11 as string,",
				"          WARNINGCODE12 as string,",
				"          WARNINGCODE13 as string,",
				"          WARNINGCODE14 as string,",
				"          WARNINGCODE15 as string,",
				"          WARNINGCODE16 as string,",
				"          WARNINGCODE17 as string,",
				"          WARNINGCODE18 as string,",
				"          WARNINGCODE19 as string,",
				"          WARNINGCODE20 as string,",
				"          SERVICE1 as string,",
				"          SERVICE2 as string,",
				"          SERVICE3 as string,",
				"          SERVICE4 as string,",
				"          SERVICE5 as string,",
				"          SERVICE6 as string,",
				"          SERVICE7 as string,",
				"          SERVICE8 as string,",
				"          SHARECODE as string,",
				"          IRSCODE as string,",
				"          DIVPOSTCODE as string,",
				"          LASTDIVDATE as string,",
				"          LASTDIVAMOUNT as string,",
				"          DIVYTD as string,",
				"          DIVLASTYEAR as string,",
				"          DIVFROMOPEN as string,",
				"          DIVTYPE as string,",
				"          DIVRATE as string,",
				"          DIVACCRUALDATE as string,",
				"          DIVACCRUAL as string,",
				"          WITHHOLDINGCODE as string,",
				"          WITHHOLDINGYTD as string,",
				"          WITHHOLDINGLASTYEAR as string,",
				"          PENALTYTYPE as string,",
				"          PENALTYYTD as string,",
				"          PENALTYLASTYEAR as string,",
				"          BALANCE as string,",
				"          ORIGINALBALANCE as string,",
				"          MINIMUMBALANCE as string,",
				"          INSURANCETYPE as string,",
				"          INSURANCEMAXIMUM as string,",
				"          INSURANCEBALANCEAGE1 as string,",
				"          INSURANCEBALANCEAGE2 as string,",
				"          INSURANCEBALANCEAGE3 as string,",
				"          INSURANCEBALANCEAGE4 as string,",
				"          MINIMUMDEPOSIT as string,",
				"          MINIMUMWITHDRAWAL as string,",
				"          WITHDRAWALLIMIT as string,",
				"          WITHDRAWALCOUNT as string,",
				"          WITHDRAWNFROMOPEN as string,",
				"          WITHDRAWALFEETYPE as string,",
				"          WITHDRAWALFEECOUNT as string,",
				"          LASTPURGEDATE as string,",
				"          STATEMENTGROUP as string,",
				"          STATEMENTDATE as string,",
				"          STATEMENTMAILCODE as string,",
				"          REGECOUNT as string,",
				"          REGDCHECKCOUNT as string,",
				"          REGDTRANSFERCOUNT as string,",
				"          MATURITYPOSTCODE as string,",
				"          MATURITYDATE as string,",
				"          TERMFREQUENCY as string,",
				"          TERMPERIOD as string,",
				"          CERTIFICATENUMBER as string,",
				"          DESCRIPTION as string,",
				"          LOANPAYMENTHOLD as string,",
				"          STATEMENTPREVDATE as string,",
				"          BONDINTYTD as string,",
				"          BONDINTLASTYEAR as string,",
				"          NSFMONTHTODATE as string,",
				"          NSFYTD as string,",
				"          NSFLASTYEAR as string,",
				"          XFRMONTHTODATE as string,",
				"          XFRYTD as string,",
				"          XFRLASTYEAR as string,",
				"          WARNINGEXPIRATION1 as string,",
				"          WARNINGEXPIRATION2 as string,",
				"          WARNINGEXPIRATION3 as string,",
				"          WARNINGEXPIRATION4 as string,",
				"          WARNINGEXPIRATION5 as string,",
				"          WARNINGEXPIRATION6 as string,",
				"          WARNINGEXPIRATION7 as string,",
				"          WARNINGEXPIRATION8 as string,",
				"          WARNINGEXPIRATION9 as string,",
				"          WARNINGEXPIRATION10 as string,",
				"          WARNINGEXPIRATION11 as string,",
				"          WARNINGEXPIRATION12 as string,",
				"          WARNINGEXPIRATION13 as string,",
				"          WARNINGEXPIRATION14 as string,",
				"          WARNINGEXPIRATION15 as string,",
				"          WARNINGEXPIRATION16 as string,",
				"          WARNINGEXPIRATION17 as string,",
				"          WARNINGEXPIRATION18 as string,",
				"          WARNINGEXPIRATION19 as string,",
				"          WARNINGEXPIRATION20 as string,",
				"          FEECOUNT1 as string,",
				"          FEECOUNT2 as string,",
				"          FEECOUNT3 as string,",
				"          FEECOUNT4 as string,",
				"          STATEWITHHOLDINGCODE as string,",
				"          STATEWITHHOLDINGYTD as string,",
				"          STATEWITHHOLDINGLASTYEAR as string,",
				"          CUTOTALSUSECODE as string,",
				"          DIVPERIODSTART as string,",
				"          DIVPERIODBALDAYS as string,",
				"          CHARGEOFFAMOUNT as string,",
				"          CHARGEOFFDATE as string,",
				"          CHARGEOFFTYPE as string,",
				"          CREDITREPORTINGCODE as string,",
				"          CREDITREPORTNUMBER as string,",
				"          BRANCH as string,",
				"          CREDITREPORTOCCURDATE as string,",
				"          CREDITREPORTLASTSTATUS as string,",
				"          CREDITREPORTCOMMENT as string,",
				"          BUMPRATE as string,",
				"          BUMPEFFECTIVEDATE as string,",
				"          BUMPEXPIRATIONDATE as string,",
				"          IRSPLAN as string,",
				"          ORIGINALDEPOSITDATE as string,",
				"          ORIGINALDEPOSIT as string,",
				"          CREDITREPORTCONSUMERINFO as string,",
				"          CREDITREPORTCOMPLIANCE as string,",
				"          ACTIVITYDATE as string,",
				"          COURTESYPAYMONTHTODATE as string,",
				"          COURTESYPAYYTD as string,",
				"          COURTESYPAYLASTYEAR as string,",
				"          OVERDRAFTTOLERANCE as string,",
				"          CDDIVACCRYTD as string,",
				"          CDDIVACCRLASTYR as string,",
				"          AMORTIZATIONSCHD as string,",
				"          AMORTIZATIONSCHDTYPE as string,",
				"          DIVIDENDRATEMARGINSIGN as string,",
				"          DIVIDENDRATEPERIODDATE as string,",
				"          DIVIDENDRATEPERIODFREQ as string,",
				"          DIVIDENDRATEMARGIN as string,",
				"          DIVIDENDRATEMAX as string,",
				"          DIVIDENDRATEMIN as string,",
				"          PERIODICCAP as string,",
				"          PERIODICSTARTRATE as string,",
				"          CALLITEMSCHD as string,",
				"          CALLITEMSCHDTYPE as string,",
				"          MEMBERUSERTRANSFERCODE as string,",
				"          CORPORATEUSERTRANSFERCODE as string,",
				"          MEMBERBRANCHSUPPORT as string,",
				"          MCDIVYTD as string,",
				"          MCDIVLASTYEAR as string,",
				"          USERCHAR1 as string,",
				"          USERCHAR2 as string,",
				"          USERCHAR3 as string,",
				"          USERCHAR4 as string,",
				"          USERAMOUNT1 as string,",
				"          USERAMOUNT2 as string,",
				"          USERDATE1 as string,",
				"          USERDATE2 as string,",
				"          PUTITEMSCHD as string,",
				"          PUTITEMSCHDTYPE as string,",
				"          LEDGERACCRUAL as string,",
				"          LEDGERACCRUALDATE as string,",
				"          CURRDIVPAYABLE as string,",
				"          CURRMONTHPAIDDIV as string,",
				"          MTDPAIDDIVS as string,",
				"          MTDACCRUEDDIVS as string,",
				"          MTDEARNEDDIVS as string,",
				"          PREMTHDIVPAID1 as string,",
				"          PREMTHDIVPAID2 as string,",
				"          PREMTHDIVPAID3 as string,",
				"          PREMTHDIVACCRUED1 as string,",
				"          PREMTHDIVACCRUED2 as string,",
				"          PREMTHDIVACCRUED3 as string,",
				"          PREMTHDIVEARNED1 as string,",
				"          PREMTHDIVEARNED2 as string,",
				"          PREMTHDIVEARNED3 as string,",
				"          PREMTHDIVEARNED4 as string,",
				"          PREMTHDIVEARNED5 as string,",
				"          PREMTHDIVEARNED6 as string,",
				"          PREMTHDIVEARNED7 as string,",
				"          PREMTHDIVEARNED8 as string,",
				"          PREMTHDIVEARNED9 as string,",
				"          PREMTHDIVEARNED10 as string,",
				"          PREMTHDIVEARNED11 as string,",
				"          PREMTHDIVEARNED12 as string,",
				"          MTDPRIORRATEACCRUAL as string,",
				"          LASTACCRUALUPDATEDATE as string,",
				"          UNPAIDFEEYTD as string,",
				"          UNPAIDFEELASTYEAR as string,",
				"          OVERDRAFTFEEYTD as string,",
				"          OVERDRAFTFEELASTYR as string,",
				"          LASTCRREPORTDATE as string,",
				"          CREDITREPORTCONSUMERINFODATE as string,",
				"          EXTACHXFRDAILYLIMITIN as string,",
				"          EXTACHXFRDAILYLIMITOUT as string,",
				"          STATEWITHHOLDINGQTD as string,",
				"          STATEWITHHOLDINGLASTQTR as string,",
				"          ANALYSISGROUPPRIMARYACCT as string,",
				"          ANALYSISGROUPPRIMARYID as string,",
				"          ANALYSISPMTACCT as string,",
				"          ANALYSISPMTSLID as string,",
				"          ANALYSISPMTIDTYPE as string,",
				"          NICKNAME as string,",
				"          RENEWSHARETYPE as string,",
				"          RENEWTERMFREQ as string,",
				"          RENEWTERMPERIOD as string,",
				"          DIVDISBUPDTACTVTYD as string,",
				"          SWEEPBALANCETYPE as string,",
				"          SWEEPTARGETMINIMUM as string,",
				"          SWEEPTARGETMAXIMUM as string,",
				"          SWEEPPRIORITY as string,",
				"          LASTDIRECTDEPDATE as string,",
				"          LASTDIRECTDEPAMT as string,",
				"          REGDCTRSTARTDAY as string,",
				"          RECORDCHANGEDATE as string,",
				"          CAPPEDFEESAMTPERIOD as string,",
				"          CAPPEDFEESAMOUNTCAP as string,",
				"          CAPPEDFEESCNTPERIOD as string,",
				"          CAPPEDFEESCOUNTCAP as string,",
				"          CREATEDBYUSER as string,",
				"          CREATEDATBRANCH as string,",
				"          ESCROWEDLOANID as string,",
				"          AUTHFEEOPTION1 as string,",
				"          AUTHFEEOPTION2 as string,",
				"          AUTHFEEOPTION3 as string,",
				"          AUTHFEEOPTION4 as string,",
				"          AUTHFEEOPTION5 as string,",
				"          ODTAUTHFEESRCCODELIST1 as string,",
				"          ODTAUTHFEESRCCODELIST2 as string,",
				"          ODTAUTHFEESRCCODELIST3 as string,",
				"          ODTAUTHFEESRCCODELIST4 as string,",
				"          FEEEXEMPTCRTSYBAL as string,",
				"          NSFFEEMTD as string,",
				"          NSFFEEYTD as string,",
				"          NSFFEELY as string,",
				"          COURTESYFEEMTD as string,",
				"          COURTESYFEEYTD as string,",
				"          COURTESYFEELY as string,",
				"          NEGATIVEBALANCEDATE as string,",
				"          CREDITREPORTORIGINALAMOUNTRPTD as string,",
				"          NEGATIVEBALANCENOTICETYPE as string,",
				"          NEGATIVEBALANCENOTICENUMBER as string,",
				"          NEGATIVEBALANCENOTICEDATE as string,",
				"          ESCROWYTD as string,",
				"          ESCROWLASTYEAR as string,",
				"          CHAPTER4WITHHOLDINGCODE as string,",
				"          CHAPTER4WITHHELDYTD as string,",
				"          CHAPTER4WITHHELDLSTYR as string,",
				"          YEARENDBALANCE as string,",
				"          IRS1042SUFID as string,",
				"          POSITIVEPAYDRAFT as string,",
				"          VERSIONID as string,",
				"          UUID as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     partitionBy('hash', 1)) ~> source",
				"source derive(share_id = concat(PWC_Key, ID),",
				"     partitionBy('hash', 1)) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          share_id as long,",
				"          min_balance as decimal(10,2),",
				"          open_date as date,",
				"          close_date as date,",
				"          original_balance as decimal(10,0),",
				"          available_balance as decimal(10,0),",
				"          curr_balance as decimal(10,0),",
				"          status as string,",
				"          branch as string,",
				"          account_type as string,",
				"          created_date as timestamp,",
				"          created_by as string,",
				"          updated_date as timestamp,",
				"          updated_by as string,",
				"          share_type_code_id as integer,",
				"          product_id as integer,",
				"          account_id as integer",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     mapColumn(",
				"          share_id,",
				"          account_id = PWC_Key,",
				"          min_balance = MINIMUMBALANCE,",
				"          open_date = OPENDATE,",
				"          close_date = CLOSEDATE,",
				"          share_type_code_id = TYPE,",
				"          original_balance = ORIGINALBALANCE,",
				"          available_balance = BALANCE,",
				"          product_id = TYPE",
				"     ),",
				"     partitionBy('hash', 1)) ~> sink1"
			]
		}
	}
}