{
	"name": "Transformation_Member_account",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "member_accountcsv",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "member_account",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          PWC_Key as string,",
				"          TYPE as string,",
				"          LASTFMDATE as string,",
				"          OPENDATE as string,",
				"          CLOSEDATE as string,",
				"          BRANCH as string,",
				"          RESTRICTACCESS as string,",
				"          REFERENCE as string,",
				"          WARNINGCODE1 as string,",
				"          WARNINGCODE2 as string,",
				"          WARNINGCODE3 as string,",
				"          WARNINGCODE4 as string,",
				"          WARNINGCODE5 as string,",
				"          WARNINGCODE6 as string,",
				"          WARNINGCODE7 as string,",
				"          WARNINGCODE8 as string,",
				"          WARNINGCODE9 as string,",
				"          WARNINGCODE10 as string,",
				"          WARNINGCODE11 as string,",
				"          WARNINGCODE12 as string,",
				"          WARNINGCODE13 as string,",
				"          WARNINGCODE14 as string,",
				"          WARNINGCODE15 as string,",
				"          WARNINGCODE16 as string,",
				"          WARNINGCODE17 as string,",
				"          WARNINGCODE18 as string,",
				"          WARNINGCODE19 as string,",
				"          WARNINGCODE20 as string,",
				"          PAYMENTHISTORY1 as string,",
				"          PAYMENTHISTORY2 as string,",
				"          PAYMENTHISTORY3 as string,",
				"          PAYMENTHISTORY4 as string,",
				"          PAYMENTHISTORY5 as string,",
				"          PAYMENTHISTORY6 as string,",
				"          MEMBERSTATUS as string,",
				"          CORRESPONDDATE as string,",
				"          PROXYDATE as string,",
				"          HEADOFHOUSEHOLD as string,",
				"          WARNINGEXPIRATION1 as string,",
				"          WARNINGEXPIRATION2 as string,",
				"          WARNINGEXPIRATION3 as string,",
				"          WARNINGEXPIRATION4 as string,",
				"          WARNINGEXPIRATION5 as string,",
				"          WARNINGEXPIRATION6 as string,",
				"          WARNINGEXPIRATION7 as string,",
				"          WARNINGEXPIRATION8 as string,",
				"          WARNINGEXPIRATION9 as string,",
				"          WARNINGEXPIRATION10 as string,",
				"          WARNINGEXPIRATION11 as string,",
				"          WARNINGEXPIRATION12 as string,",
				"          WARNINGEXPIRATION13 as string,",
				"          WARNINGEXPIRATION14 as string,",
				"          WARNINGEXPIRATION15 as string,",
				"          WARNINGEXPIRATION16 as string,",
				"          WARNINGEXPIRATION17 as string,",
				"          WARNINGEXPIRATION18 as string,",
				"          WARNINGEXPIRATION19 as string,",
				"          WARNINGEXPIRATION20 as string,",
				"          NSFMONTHLYCOUNT1 as string,",
				"          NSFMONTHLYCOUNT2 as string,",
				"          NSFMONTHLYCOUNT3 as string,",
				"          NSFMONTHLYCOUNT4 as string,",
				"          NSFMONTHLYCOUNT5 as string,",
				"          NSFMONTHLYCOUNT6 as string,",
				"          NSFMONTHLYCOUNT7 as string,",
				"          NSFMONTHLYCOUNT8 as string,",
				"          NSFMONTHLYCOUNT9 as string,",
				"          NSFMONTHLYCOUNT10 as string,",
				"          NSFMONTHLYCOUNT11 as string,",
				"          NSFMONTHLYCOUNT12 as string,",
				"          NSFMONTHLYCOUNT13 as string,",
				"          NSFMONTHLYCOUNT14 as string,",
				"          NSFMONTHLYCOUNT15 as string,",
				"          NSFMONTHLYCOUNT16 as string,",
				"          NSFMONTHLYCOUNT17 as string,",
				"          NSFMONTHLYCOUNT18 as string,",
				"          NSFMONTHLYCOUNT19 as string,",
				"          NSFMONTHLYCOUNT20 as string,",
				"          NSFMONTHLYCOUNT21 as string,",
				"          NSFMONTHLYCOUNT22 as string,",
				"          NSFMONTHLYCOUNT23 as string,",
				"          NSFMONTHLYCOUNT24 as string,",
				"          NSFTODAY as string,",
				"          MEMBERGROUP as string,",
				"          COMMERCIALCODE as string,",
				"          FMLASTPURGEDATE as string,",
				"          STATEREPORTING as string,",
				"          HOUSEHOLDACCOUNT as string,",
				"          HOUSEHOLDSTATEMENT as string,",
				"          FROZENMODE as string,",
				"          INVALIDATTEMPTCOUNT as string,",
				"          INVALIDATTEMPTDATE as string,",
				"          INVALIDATTEMPTTIME as string,",
				"          STATEMENTMAILCODE as string,",
				"          RELATIONSHIPCODE as string,",
				"          RELATIONSHIPOVERRIDE as string,",
				"          RELATIONSHIPOVERRIDEEFFDATE as string,",
				"          RELATIONSHIPOVERRIDEEXPDATE as string,",
				"          KRHOLDBASEAMOUNT as string,",
				"          KRTOTALAMOUNT as string,",
				"          KRTOTALDATE as string,",
				"          ESTMTNOTIFY as string,",
				"          ESTMTENABLE as string,",
				"          CRTOTALAMOUNT as string,",
				"          CDTOTALAMOUNT as string,",
				"          FRCRTOTALAMOUNT as string,",
				"          FRCDTOTALAMOUNT as string,",
				"          USERCHAR1 as string,",
				"          USERCHAR2 as string,",
				"          USERCHAR3 as string,",
				"          USERCHAR4 as string,",
				"          USERAMOUNT1 as string,",
				"          USERAMOUNT2 as string,",
				"          USERDATE1 as string,",
				"          USERDATE2 as string,",
				"          ENABLEFLOAT as string,",
				"          FRCRUNITS as string,",
				"          FRCDUNITS as string,",
				"          PRGDRECACTIVITYDT as string,",
				"          RECORDCHANGEDATE as string,",
				"          CAPPEDFEESCOUNTCAP as string,",
				"          CAPPEDFEESAMOUNTCAP as string,",
				"          CREATEDBYUSER as string,",
				"          CREATEDATBRANCH as string,",
				"          WRTOTALAMOUNT as string,",
				"          WDTOTALAMOUNT as string,",
				"          NONREGCCCHECKHOLDBASEAMT as string,",
				"          NONREGCCCHECKTOTALAMT as string,",
				"          LIMITUSAGEDATE as string,",
				"          COUNTLIMIT1 as string,",
				"          COUNTLIMIT2 as string,",
				"          COUNTLIMIT3 as string,",
				"          COUNTLIMIT4 as string,",
				"          COUNTLIMIT5 as string,",
				"          COUNTLIMIT6 as string,",
				"          LIMITCOUNT1 as string,",
				"          LIMITCOUNT2 as string,",
				"          LIMITCOUNT3 as string,",
				"          LIMITCOUNT4 as string,",
				"          LIMITCOUNT5 as string,",
				"          LIMITCOUNT6 as string,",
				"          LIMIT1 as string,",
				"          LIMIT2 as string,",
				"          LIMIT3 as string,",
				"          LIMIT4 as string,",
				"          LIMIT5 as string,",
				"          LIMIT6 as string,",
				"          LIMITAMOUNT1 as string,",
				"          LIMITAMOUNT2 as string,",
				"          LIMITAMOUNT3 as string,",
				"          LIMITAMOUNT4 as string,",
				"          LIMITAMOUNT5 as string,",
				"          LIMITAMOUNT6 as string,",
				"          PERITEMLIMIT1 as string,",
				"          PERITEMLIMIT2 as string,",
				"          PERITEMLIMIT3 as string,",
				"          PERITEMLIMIT4 as string,",
				"          PERITEMLIMIT5 as string,",
				"          PERITEMLIMIT6 as string,",
				"          VERSIONID as string,",
				"          UUID as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     partitionBy('hash', 1)) ~> source1",
				"source1 derive(product_id = iifNull(TYPE,'p')) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          account_id as integer,",
				"          min_balance as decimal(10,2),",
				"          open_date as date,",
				"          close_date as date,",
				"          branch as string,",
				"          status as string,",
				"          household_account_number as string,",
				"          member_group_name as string,",
				"          product_id as integer,",
				"          created_date as timestamp,",
				"          created_by as string,",
				"          updated_date as timestamp,",
				"          updated_by as string,",
				"          account_type_id as integer,",
				"          anonymized_member_id as long",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     mapColumn(",
				"          account_id = PWC_Key,",
				"          open_date = OPENDATE,",
				"          close_date = CLOSEDATE,",
				"          account_type_id = TYPE,",
				"          branch = BRANCH,",
				"          product_id",
				"     ),",
				"     partitionBy('hash', 1)) ~> sink1"
			]
		}
	}
}